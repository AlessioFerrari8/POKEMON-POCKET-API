<div class="bg-[#0a0e27]">
  <app-search-bar></app-search-bar>

  <!-- Modal per i dettagli della carta -->
  @if(selectedCard()) {
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" (click)="closeCardDetail()">
      <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4 max-h-screen overflow-y-auto" (click)="$event.stopPropagation()">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-bold text-gray-900">{{ selectedCard()!.name }}</h2>
          <button (click)="closeCardDetail()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>
        @if(isLoadingDetails()) {
          <p class="text-gray-500 text-center">Loading details...</p>
        } @else {
          <app-card-item [card]="selectedCard()!"></app-card-item>
        }
      </div>
    </div>
  }
  
  @if(!hasSearched() || cardsWithImages().length === 0) {
    <!-- PARTE POSTER -->
    <div id="poster" class="relative w-full flex-grow flex items-center justify-center mt-64">
      <div 
        (mouseenter)="onCardHover(0)"
        [class.z-50]="selectedCardIndex() === 0"
        class="absolute z-30 transform hover:scale-110 transition-transform duration-300">
        <img src="/cards_poster/mewto.png" alt="Pokemon Card" class="w-64 rounded-lg shadow-2xl">
      </div>
      <div 
        (mouseenter)="onCardHover(1)"
        [class.z-50]="selectedCardIndex() === 1"
        class="absolute z-20 transform -rotate-12 -translate-x-48 hover:z-40 hover:scale-110 transition-all duration-300">
        <img src="/cards_poster/charizard.png" alt="Pokemon Card" class="w-60 rounded-lg shadow-xl">
      </div>
      <div 
        (mouseenter)="onCardHover(2)"
        [class.z-50]="selectedCardIndex() === 2"
        class="absolute z-20 transform rotate-12 translate-x-48 hover:z-40 hover:scale-110 transition-all duration-300">
        <img src="/cards_poster/haunter.jpg" alt="Pokemon Card" class="w-60 rounded-lg shadow-xl">
      </div>
      <div 
        (mouseenter)="onCardHover(3)"
        [class.z-50]="selectedCardIndex() === 3"
        class="absolute z-10 transform -rotate-20 -translate-x-80 hover:z-40 hover:scale-130 transition-all duration-300">
        <img src="/cards_poster/pikachu.jpg" alt="Pokemon Card" class="w-56 rounded-lg shadow-lg opacity-95 hover:opacity-100">
      </div>
      <div 
        (mouseenter)="onCardHover(4)"
        [class.z-50]="selectedCardIndex() === 4"
        class="absolute z-10 transform rotate-20 translate-x-80 hover:z-40 hover:scale-125 transition-all duration-300">
        <img src="/cards_poster/squirtle.webp" alt="Pokemon Card" class="w-56 rounded-lg shadow-lg opacity-95 hover:opacity-100">
      </div>
      <div 
        (mouseenter)="onCardHover(5)"
        [class.z-50]="selectedCardIndex() === 5"
        class="absolute z-0 transform rotate-28 translate-x-112 hover:z-40 hover:scale-150 transition-all duration-300">
        <img src="/cards_poster/ivysaur.png" alt="Pokemon Card" class="w-52 rounded-lg shadow-md opacity-90 hover:opacity-100">
      </div>
      <div 
        (mouseenter)="onCardHover(6)"
        [class.z-50]="selectedCardIndex() === 6"
        class="absolute z-0 transform -rotate-28 -translate-x-112 hover:z-40 hover:scale-150 transition-all duration-300">
        <img src="/cards_poster/blaziken.png" alt="Pokemon Card" class="w-52 rounded-lg shadow-md opacity-90 hover:opacity-100">
      </div>
      <div class="absolute translate-x-180 translate-y-60">
        <img src="gengar.webp" alt="Pokemon Card">
      </div>
      <div class="absolute -translate-x-180 translate-y-60">
        <img src="lucario.webp" alt="Pokemon Card">
      </div>
      <div class="absolute translate-y-90">
        <img src="greninja.webp" alt="Pokemon Card">
      </div>
    </div>
    <!-- FINE PARTE POSTER -->
  } @else {
    <div class="container mx-auto px-4 py-8 flex-grow">
      <div class="mb-6 text-center">
        <p class="text-gray-600 text-sm mb-4 text-center">Found {{ cardsWithImages().length }} cards</p>
      </div>
      <app-card-grid [cards]="cardsWithImages()" (cardClicked)="onCardClicked($event)"></app-card-grid>
    </div>
  }
</div>

